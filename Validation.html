<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Validation - Project Eucalyptus 🌿</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/fontawesome.min.css" rel="stylesheet">
        <link href="css/brands.min.css" rel="stylesheet">
        <link href="css/solid.min.css" rel="stylesheet">
        <link href="css/v4-font-face.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="index.html">Project Eucalyptus 🌿</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="index.html" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="Data.html" class="nav-link">Data</a>
                            </li>
                            <li class="nav-item">
                                <a href="Radiative_Transfer.html" class="nav-link">Radiative transfer</a>
                            </li>
                            <li class="nav-item">
                                <a href="Model.html" class="nav-link">Model</a>
                            </li>
                            <li class="nav-item">
                                <a href="Validation.html" class="nav-link active" aria-current="page">Validation</a>
                            </li>
                            <li class="nav-item">
                                <a href="Postprocessing.html" class="nav-link">Postprocessing</a>
                            </li>
                            <li class="nav-item">
                                <a href="Landsat.html" class="nav-link">Landsat</a>
                            </li>
                            <li class="nav-item">
                                <a href="Hyperspectral.html" class="nav-link">Hyperspectral</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="Model.html" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="Postprocessing.html" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/Orbio-Earth/Project-Eucalyptus" class="nav-link"><i class="fa-brands fa-github"></i> GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#validation" class="nav-link">Validation</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#references" class="nav-link">References</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="validation">Validation</h1>
<h3 id="how-do-you-assess-model-performance">How do you assess model performance?</h3>
<p>We assess model performance through a combination of synthetic plumes, ground truth emissions, and metrics tailored to production constraints, such as the <a href="Validation.html#how-do-you-estimate-the-detection-threshold-of-your-model">detection threshold</a>. These constraints reflect the trade-off we face in production between high detection sensitivity and keeping false positives low enough to avoid overwhelming downstream QA and users.</p>
<p>During training, we minimize a custom loss function that balances methane detection (via binary classification) and quantification (via conditional regression). See <a href="Model.html#what-is-the-loss-function-used-for-training">here</a> for more details on the loss function. The <a href="Data.html#how-was-the-validation-dataset-created">validation dataset</a> consists of synthetic plumes injected into real satellite scenes across three representative regions: <a href="Validation.html#why-have-you-selected-these-three-specific-regions-to-validate-in">Hassi/Permian/Marcellus</a>. At regular intervals during training, we evaluate model performance on this synthetic validation dataset. We select the best checkpoint based on recall, computed at a detection threshold that is tuned to meet a fixed false positive constraint. See <a href="Validation.html#what-metrics-do-you-use-during-model-training">here</a> for more details.</p>
<p>In addition to synthetic evaluation, we test model performance against a curated list of real world ground truth emission events compiled from various studies, including Varon et al. (2021), IMEO Notified Plumes (reported high-emission events from the UN’s International Methane Emissions Observatory), and SBR field campaigns (Single-Blind Release studies conducted by Stanford that provide known, independently quantified plumes under controlled conditions). These include known plumes with verified emission rates across sites in Algeria, Turkmenistan, the US, and more. Ground truth checks help confirm the model can generalize to real data and not just synthetic proxies.</p>
<h3 id="what-are-the-results-of-your-best-model">What are the results of your best model?</h3>
<p>Our best model achieves high sensitivity to methane plumes while maintaining strict false positive controls. Here we summarize the <a href="Validation.html#how-do-you-estimate-the-detection-threshold-of-your-model">detection threshold</a> (DT) results from synthetic plumes and performance on known true positive cases (ground truth).</p>
<h4 id="detection-threshold-results">Detection Threshold Results</h4>
<p>The model’s sensitivity varies by geography, reflecting differences in scene noise, terrain, and atmospheric conditions. For each region, we report the emission rate that is detected in 10%, 50%, and 90% of cases (=probability of detection (POD) levels).
<img alt="image7" src="images/image9.png" />
<strong>Hassi (Algeria)</strong></p>
<ul>
<li>We detect emissions of 260 kg/hr in 10% of cases</li>
<li>50% DT: 620 kg/hr</li>
<li>90% DT: 1593 kg/hr</li>
</ul>
<p><strong>Permian (USA)</strong></p>
<ul>
<li>10% DT:  666 kg/hr</li>
<li>50% DT: 1776 kg/hr</li>
<li>90% DT: 5753 kg/hr</li>
</ul>
<p><strong>Marcellus (USA)</strong></p>
<ul>
<li>10% DT: 2344 kg/hr</li>
<li>50% DT: 8535 kg/hr</li>
<li>90% DT: &gt;25000 kg/hr</li>
</ul>
<p>These thresholds reflect the emission sizes the model can detect at each confidence level, under a controlled false positive rate of 2 FP plumes per 500x500 px area.</p>
<p>These results directly inform the model’s utility in operational settings, by helping users understand the minimum emission rates they can expect the model to reliably capture. In practice, this means that in regions like the Permian, the model is likely to detect most large emitter events but may miss smaller emissions below around 600 kg/h. While in Hassi-like regions, the model is more sensitive and can pick up quite low emissions.</p>
<h4 id="ground-truth-dataset-single-blind-release-performance">Ground Truth Dataset (Single Blind Release) Performance</h4>
<p>The model’s performance on ground truth data was also promising. Here we showcase its performance on the Single Blind Release (SBR) site at Casa Grande. From the 2022 and 2024 campaigns, there were 35 controlled events: 13 methane releases and 22 no-release scenes. The model achieved:</p>
<ul>
<li>10 true positives</li>
<li>22 true negatives</li>
<li>0 false positives</li>
<li>3 false negatives</li>
</ul>
<p>This performance indicates strong real-world detection capability at the Casa Grande site, with high precision and only a few missed detections. The complete absence of false positives is especially promising, suggesting good robustness to background noise in clean scenes. However, the three missed plumes highlight that lower-emission or visually subtle releases can still be challenging under certain conditions. Below, we show three representative examples to illustrate these outcomes:</p>
<p><img alt="image8" src="images/image15.png" />
This is an example of a <strong>high confidence true positive</strong>, where the model cleanly detects the release. The expected emission rate was 1358 kg/hr and we quantified 1509 kg/hr.</p>
<p><img alt="image9" src="images/image12.png" />
This is an example of another <strong>true positive but with nearby false positives</strong>. The actual emission was 628 kg/hr, we detected 900 kg/hr.</p>
<p><img alt="image10" src="images/image3.png" />
Lastly, this is an example of a <strong>missed detection</strong>. Although this was a medium sized emission event (763 kg/hr), our model was not able to pick it up. This could be explained by the fact there is a slight haze over the emission site, which hinders the model’s ability to detect.</p>
<h3 id="why-have-you-selected-these-three-specific-regions-to-validate-in">Why have you selected these three specific regions to validate in?</h3>
<p>These regions allow us to evaluate our model’s generalizability and false positive rate (FPR) performance under varying environmental conditions, specifically in areas we actively run our models (major oil and gas producing areas). Each region maps to a distinct Signal-to-Noise Ratio (SNR) tier, allowing us to benchmark model behavior across easy, medium, and hard detection settings.</p>
<p><strong>Tier 1: Easy — Hassi Messaoud (Algeria)</strong></p>
<ul>
<li><strong>Environment:</strong> Desert-like, minimal vegetation</li>
<li><strong>Rationale:</strong> This region offers high SNR conditions that are ideal for detecting methane. It serves as a “best-case” environment, allowing us to establish a baseline FPR under clean, low-noise conditions</li>
</ul>
<p><strong>Tier 2: Medium — Permian Basin (USA)</strong></p>
<ul>
<li>Environment: Mixed vegetation, brush, sparse vegetation</li>
<li>Rationale: The Permian is a high-emission oil and gas region with moderate background complexity and reflectance  It represents a moderate SNR — realistic for detection but still prone to moderate false positives</li>
</ul>
<p><strong>Tier 3: Hard — Marcellus Shale (USA)</strong></p>
<ul>
<li><strong>Environment:</strong> Forested, agricultural, hilly terrain</li>
<li><strong>Rationale:</strong> Marcellus provides the most challenging conditions for methane detection due to its low SNR and complex backgrounds. It defines the model’s worst-case false positive behavior and sets realistic expectations for performance in difficult scenes. Validating in this region stress-tests our model’s robustness</li>
</ul>
<h3 id="what-metrics-do-you-use-during-model-training">What metrics do you use during model training?</h3>
<p>As the main validation metric, we selected average Recall over multiple emission buckets and averaged over the three regions <a href="Validation.html#why-have-you-selected-these-three-specific-regions-to-validate-in">Hassi/Permian/Marcellus</a>. Recall is calculated using a classification threshold that allows for 10 false positive pixels on average over all 128x128 validation crops.</p>
<p>Balancing False Positives and Recall allows us to select the model that offers the highest sensitivity (i.e. best detection accuracy) without exceeding our target noise tolerance. We have found that performance of the regression part of the model correlates highly with the performance of the binary part of the model. See <a href="https://github.com/Orbio-Earth/Eucalyptus-code-archive/blob/main/methane-cv/src/training/training_script.py#L1378">here</a> for the implementation of validation.</p>
<p>We also output metric visualizations after each validation epoch. The False Positive Px Rate Curves show the Likelihood threshold (which is the binary threshold * 10) that was selected to give 10px on average over all validation chips and all three regions.<img alt="image11" src="images/image1.png" />
Given this threshold, we calculate the Recall (Detection Probability) for different emission rate buckets for the three regions. Averaging over emission rates and regions gives us the final average Recall value we track for overall performance.</p>
<p>For the below example we get:</p>
<p>mAvgRecall: 42.7% (Hassi: 72.9%, Marcellus: 10.8%, Permian: 44.4%)</p>
<p><img alt="image12" src="images/image11.png" /></p>
<h3 id="how-do-you-estimate-the-detection-threshold-of-your-model">How do you estimate the detection threshold of your model?</h3>
<p>To get to an answer to the question “we can detect plumes of X kg/hr in Y% of cases” we developed the following detection threshold method, which we run on models we want to release to production. This method is approximated during training as described <a href="Validation.html#what-metrics-do-you-use-during-model-training">here</a>.</p>
<p>We have a dataset of simulated methane plumes produced by Gorroño et al. (2023) using large eddy simulations. For each plume, there is a raster of concentration, and a flow rate at the source. We can scale a plume up and down as the concentrations are proportional to the flow rate.</p>
<p>Using this, taking a single plume in a single scene, we can insert a plume with a known emission rate into the target scene, and see if a model can detect it. The computer vision models return a likelihood score, so rather than a yes or no answer, we can look at the likelihood score (more precisely: the maximum of the likelihood score within the footprint of the plume) as the plume gets stronger. We can produce a graph that looks like this.<img alt="image13" src="images/image16.png" /></p>
<p>Taking this one step further, still for a single tile or crop, we can use all of the simulations we have, and randomly move and rotate them around the scene, still with a range of intensities. Imagine getting hundreds of curves like the one above. We can then start making probabilistic statements about detections in this scene. If we choose a likelihood score threshold for detections (say, we accept all plumes above 4/10), then we can calculate the percentage of detections for every plume size. We can now make statements like "a plume of size 1,500 kg/hr would have a 40% probability of being detected by our model near this asset on this date." Graphically, it would look something like:<img alt="image14" src="images/image6.png" />
For any choice of detection threshold, we get a different curve. We can put all of them on the same graph. This is still for a single site on one date.<img alt="image15" src="images/image2.png" />The last step is to repeat this exercise for an entire area of interest (e.g. the Permian basin), select a Likelihood Score that yields an acceptable number of False Positives and to report the emission rates we can detect in 10%/50%/90% of cases.
For finding the Likelihood Score with an acceptable number of False Positive plume detections, we can run the model over many chips without methane and plot the relationship between Threshold (= used interchangeably with Likelihood Score, LS is just scaled to lie between 0-10 whereas Threshold/Marker Threshold lie between 0-1) and average False Positive plumes (connected plume objects, not pixels). Below, this was normalized to produce an average of 2 False Positive plumes averaged over the three regions per 500x500 px tile, because we used 500x500 px tiles in production.
<img alt="image16" src="images/image7.png" />
The magenta line at FP=2 gives us a Likelihood Threshold of 3.044 which we can use to create our final mean Detection Curves.</p>
<p>For Hassi, we detect emissions of 260 kg/h in 10% of cases, 620 kg/h in 50% and 1593 kg/h in 90%.
For Permian, we detect emissions of 666 kg/h in 10% of cases, 1776 kg/h in 50% and 5753 kg/h in 90%.
For Marcellus, we detect emissions of 2344 kg/h in 10% of cases, 8535 kg/h in 50% and &gt;25000 kg/h in 90%.<img alt="image7" src="images/image9.png" /></p>
<h3 id="does-strong-performance-on-real-world-test-data-eg-ground-truth-plumes-mean-the-model-is-ready-for-production">Does strong performance on real world test data (e.g. ground truth plumes) mean the model is ready for production?</h3>
<p>Not necessarily.</p>
<p>Methane detection in satellite imagery is fundamentally difficult. Plumes can be faint, variable, and easily confounded by clouds, terrain, haze, and sensor noise. Even when the model performs well on real emission events, this doesn’t guarantee readiness for automated, wide-scale deployment—especially given how limited and noisy real ground truth data typically is.</p>
<p>Single Blind Release (SBR) studies offer a rigorous benchmark: methane is released at known times and rates while modelers remain blinded, allowing for objective validation against high confidence ground truth data. These studies typically occur in clean desert environments, which reduces ambiguity from vegetation. But even under these favourable conditions, models can fail to detect low rate emissions or struggle with false positives. This highlights just how sensitive and error-prone the detection task can be.</p>
<p>Moreover, production use requires much more than success on curated cases. The model must:</p>
<ul>
<li>Operate across millions of diverse, uncurated scenes with no prior hints of where emissions may occur</li>
<li>Generalize across regions, seasons, and image quality</li>
<li>Maintain strict false positive controls to avoid overwhelming QA</li>
</ul>
<p>That’s why strong performance on real-world test cases like SBRs is necessary—but not sufficient. We supplement them with synthetic plumes, regional validation datasets, and controlled FPR benchmarking to assess model reliability under realistic, scalable operational conditions.</p>
<h2 id="references">References</h2>
<p>Gorroño, Javier, Daniel J. Varon, Itziar Irakulis-Loitxate, and Luis Guanter. "Understanding the potential of Sentinel-2 for monitoring methane point emissions." <em>Atmospheric Measurement Techniques</em> 16, no. 1 (2023): 89-107.</p>
<p>Varon, Daniel J., Daniel J. Jacob, Jason McKeever, Dylan Jervis, Berke OA Durak, Yan Xia, and Yi Huang. "Quantifying methane point sources from fine-scale satellite observations of atmospheric methane plumes." <em>Atmospheric Measurement Techniques</em> 11, no. 10 (2018): 5673-5686.</p>
<p>Varon, Daniel J., Dylan Jervis, Jason McKeever, Ian Spence, David Gains, and Daniel J. Jacob. "High-frequency monitoring of anomalous methane point sources with multispectral Sentinel-2 satellite observations." <em>Atmospheric Measurement Techniques</em> 14, no. 4 (2021).</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js"></script>
        <script src="javascripts/mathjax.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
